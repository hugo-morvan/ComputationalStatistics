---
title: "732A90 Lab 2"
author: "Daniele Bozzi & Hugo Morvan"
date: "`r Sys.Date()`"
output: pdf_document
editor_options: 
  chunk_output_type: console
---
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Question 1: Optimisation of a two-dimensional function

### a)
```{r}
f <- function(x, y){
  return(0)
}
f_x <- function(x,y){
  return(-2*x -2*x*y^2 -2*y +2)
}
f_y <- function(x,y){
  return(-2*x^2*y-2*x)
}
f_xy <- function(x,y){
  return(-4*x*y-2)
}
f_xx <- function(x,y){
  return(-2 -2*y^2)
}
f_yy <- function(x,y){
  return(-2*x^2)
}
get_hessian_mat <- function(x,y){
  hess <- matrix(c(f_xx(x,y), f_xy(x,y), f_xy(x,y), f_yy(x,y)), ncol=2)
  return(hess)
}

#get_hessian_mat(0,0)

f <- function(x,y){
  return((-x^2)-(x^2*y^2)-(2*x*y)+(2*x)+2)
}

x <- seq(-3,3,0.05)
y <- seq(-3,3,0.05)

lx <- length(x)
ly <- length(y)

points1 <- matrix(0,nrow=lx, ncol=ly)

for (i in 1:lx){
  for (q in 1:ly){
    points1[i,q] <- f(x[i], y[q])
  }
}

contour(x,y,points1, nlevels=50)

# b)

```


```{r}
f <- function(x,y){
  return(-x^2-x^2*y^2-2*x*y+2*x+2)
}

x <- seq(-10,10,0.1)
y <- seq(-10,10,0.1)

length(y)

points1 <- matrix(0,nrow=length(x), ncol=length(x))

for (i in 1:length(x)){
  for (q in 1:length(x)){
    points1[i,q] <- f(x[i], y[q])
  }
}


contour(x,y,points1)
points(-3,3,col="red")

```

```{r}
newton <- function(x, epsilon){
  #x is you starting vector
  dist <- 999
  
  while(dist > epsilon){
    gp <- get_gradient(x)
    gpp <- get_hessian(x)
    x_next <- x - solve(gpp)%*%gp
    dist <- sum((x-x_next)*(x-x_next))
    x <- x_next
  }
  return(x)
}
p1 <- c(2,0)
p2 <- c(-1,-2)
p3 <- c(0,1)
p4 <- c(10,-10)
epsilon <- 1E-8
newton(p1, epsilon)
newton(p2, epsilon)
newton(p3, epsilon)
newton(p4, epsilon)

```
We obtain 2 points : (0,1) and (1,-1)

```{r}
print("Gradient and Hessian for the point (0,1)")
get_gradient(c(0,1))
get_hessian(c(0,1))
print("this is a saddle point")
#print("the matrix is negative semi-definite")

print("Gradient and Hessian for the point (1,-1)")
get_gradient(c(1,-1))
get_hessian(c(1,-1))

print("this is a maximum")

```


### b)

### c)

### d)


## Question 2:

### a)

### b)

### c)

### d)
